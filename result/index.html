<!DOCTYPE html>
<!-- saved from url=(0030)https://cid.piterjs.org/result -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>PiterJS - Results of code in the dark</title>
<link href="./index_files/css" rel="stylesheet">
<style>
    body {
        background-color: #111;
        color: #fafafa;
        font-family: 'Source Sans Pro', sans-serif;
    }
    h1 span {
        color: #59cb8f;
        font-size: 2em;
    }
    .logo {
        max-width: 100%;
        height: auto;
    }
    .wrapper {
        max-width: 90%;
        margin: auto;
        text-align: center;
    }
    .results {
        margin-top: 40px;
    }
    .results td {
        border: 1px solid #333;
        border-radius: 3px;
        padding: 2px 10px;
        text-align: center;
    }
    .results thead td {
        color: #59cb8f;
        font-weight: bold;
        padding: 10px;
        text-align: center;
    }
    .results img {
        max-width: 100%;
    }
</style>
</head>

<body>

    <div class="wrapper">
        <h1>
            PiterJS - Результаты соревнования<br>
            <span>CODE IN THE DARK</span>
        </h1>
        <table class="results">
            <thead>
                <tr>
                    <td>Имя</td>
                    <td>Отклонение</td>
                    <td>Результат</td>
                    <td>Оригинал</td>
                    <td>Разница</td>
                </tr>
            </thead>
            <tbody id="results"><tr>
            <td>Egor M</td>
            <td>0.66451</td>
            <td>
                <a href="./index_files/Egor M-2-1535811419520.png" target="_blank">
                    <img src="./index_files/Egor M-2-1535811419520.png" alt="">
                </a>
            </td>
            <td>
                <a href="./index_files/2.png" target="_blank">
                    <img src="./index_files/2.png" alt="">
                </a>
            </td>
            <td>
                <a href="./index_files/Egor M-2-1535811419520-0.66451.diff.png" target="_blank">
                    <img src="./index_files/Egor M-2-1535811419520-0.66451.diff.png" alt="">
                </a>
            </td>
        </tr> <tr>
            <td>null</td>
            <td>0.47832</td>
            <td>
                <a href="./index_files/null-1-1535807175031.png" target="_blank">
                    <img src="./index_files/null-1-1535807175031.png" alt="">
                </a>
            </td>
            <td>
                <a href="./index_files/1.png" target="_blank">
                    <img src="./index_files/1.png" alt="">
                </a>
            </td>
            <td>
                <a href="./index_files/null-1-1535807175031-0.47832.diff.png" target="_blank">
                    <img src="./index_files/null-1-1535807175031-0.47832.diff.png" alt="">
                </a>
            </td>
        </tr> <tr>
            <td>Polina</td>
            <td>0.44234</td>
            <td>
                <a href="./index_files/Polina-2-1535810664772.png" target="_blank">
                    <img src="./index_files/Polina-2-1535810664772.png" alt="">
                </a>
            </td>
            <td>
                <a href="./index_files/2.png" target="_blank">
                    <img src="./index_files/2.png" alt="">
                </a>
            </td>
            <td>
                <a href="./index_files/Polina-2-1535810664772-0.44234.diff.png" target="_blank">
                    <img src="./index_files/Polina-2-1535810664772-0.44234.diff.png" alt="">
                </a>
            </td>
        </tr> <tr>
            <td>bmsdave</td>
            <td>0.41706</td>
            <td>
                <a href="./index_files/bmsdave-1-1535807159677.png" target="_blank">
                    <img src="./index_files/bmsdave-1-1535807159677.png" alt="">
                </a>
            </td>
            <td>
                <a href="./index_files/1.png" target="_blank">
                    <img src="./index_files/1.png" alt="">
                </a>
            </td>
            <td>
                <a href="./index_files/bmsdave-1-1535807159677-0.41706.diff.png" target="_blank">
                    <img src="./index_files/bmsdave-1-1535807159677-0.41706.diff.png" alt="">
                </a>
            </td>
        </tr> <tr>
            <td>Sloboda Daniil</td>
            <td>0.26214</td>
            <td>
                <a href="./index_files/Sloboda Daniil-2-1535810660927.png" target="_blank">
                    <img src="./index_files/Sloboda Daniil-2-1535810660927.png" alt="">
                </a>
            </td>
            <td>
                <a href="./index_files/2.png" target="_blank">
                    <img src="./index_files/2.png" alt="">
                </a>
            </td>
            <td>
                <a href="./index_files/Sloboda Daniil-2-1535810660927-0.26214.diff.png" target="_blank">
                    <img src="./index_files/Sloboda Daniil-2-1535810660927-0.26214.diff.png" alt="">
                </a>
            </td>
        </tr> <tr>
            <td>saitonakamura</td>
            <td>0.12439</td>
            <td>
                <a href="./index_files/saitonakamura-2-1535811433876.png" target="_blank">
                    <img src="./index_files/saitonakamura-2-1535811433876.png" alt="">
                </a>
            </td>
            <td>
                <a href="./index_files/2.png" target="_blank">
                    <img src="./index_files/2.png" alt="">
                </a>
            </td>
            <td>
                <a href="./index_files/saitonakamura-2-1535811433876-0.12439.diff.png" target="_blank">
                    <img src="./index_files/saitonakamura-2-1535811433876-0.12439.diff.png" alt="">
                </a>
            </td>
        </tr> <tr>
            <td>Alexander Bushmanov</td>
            <td>0.02871</td>
            <td>
                <a href="./index_files/Alexander Bushmanov-1-1535808098307.png" target="_blank">
                    <img src="./index_files/Alexander Bushmanov-1-1535808098307.png" alt="">
                </a>
            </td>
            <td>
                <a href="./index_files/1.png" target="_blank">
                    <img src="./index_files/1.png" alt="">
                </a>
            </td>
            <td>
                <a href="./index_files/Alexander Bushmanov-1-1535808098307-0.02871.diff.png" target="_blank">
                    <img src="./index_files/Alexander Bushmanov-1-1535808098307-0.02871.diff.png" alt="">
                </a>
            </td>
        </tr> <tr>
            <td>Stepan Shutov</td>
            <td>0.00552</td>
            <td>
                <a href="./index_files/Stepan Shutov-1-1535808098925.png" target="_blank">
                    <img src="./index_files/Stepan Shutov-1-1535808098925.png" alt="">
                </a>
            </td>
            <td>
                <a href="./index_files/1.png" target="_blank">
                    <img src="./index_files/1.png" alt="">
                </a>
            </td>
            <td>
                <a href="./index_files/Stepan Shutov-1-1535808098925-0.00552.diff.png" target="_blank">
                    <img src="./index_files/Stepan Shutov-1-1535808098925-0.00552.diff.png" alt="">
                </a>
            </td>
        </tr></tbody>
        </table>
    </div>
<script>
const regexRes = /cid\/([\S ]+)-([\S ]+)-([\S ]+)-([\S ]+)\.diff\.png/
const regexDist = /cid\/([\S ]+)-([\S ]+)-([\S ]{13})\.png/

function getResults() {
    var x = new XMLHttpRequest();
    x.open("GET", "/api/result", true);
    x.onload = function () {
        console.log(x.responseText);
        const plain = x.responseText
        const json = JSON.parse(plain)
        window.json = json
        window.res = json.filter((item) => regexRes.test(item.name))
        window.resDist = json.filter((item) => regexDist.test(item.name))
        buildTable(window.res)
    }
    x.send();
}

getResults()

function parseResults(res, regex) {
    const results = res.map((item, index) => {
        const resultName = item.name
        const parsed = regex.exec(resultName)

        return {
            name: parsed[1],
            template: parsed[2],
            itemName: item.name,
            diff: parsed[4],
            id: parsed[3]
        }
    })
    return results
}

function sortResults(results) {
    return results.sort(function(prev, next) {
        return Number(next.diff) - Number(prev.diff)
    })
}

function buildTable(res) {
    const $results = document.querySelector('#results')
    const results = sortResults(parseResults(window.res, regexRes))
    const resultsDist = sortResults(parseResults(window.resDist, regexDist))

    $results.innerHTML = results.map((item, index) => {
        const distName = `/api/get/${resultsDist.find((x)=>{return x.id === item.id }) && resultsDist.find((x)=>{return x.id === item.id }).itemName}`
        const template = `/api/get/cid/${item.template}.png`
        const resName = `/api/get/${results[index].itemName}`
        return `<tr>
            <td>${item.name}</td>
            <td>${item.diff}</td>
            <td>
                <a href="${distName}" target="_blank">
                    <img src="${distName}" alt="" />
                </a>
            </td>
            <td>
                <a href="${template}" target="_blank">
                    <img src="${template}" alt="" />
                </a>
            </td>
            <td>
                <a href="${resName}" target="_blank">
                    <img src="${resName}" alt="" />
                </a>
            </td>
        </tr>`
    }).join(' ')
}

function ready() {
    getResults()
}
document.addEventListener("DOMContentLoaded", ready);
</script>


</body></html>